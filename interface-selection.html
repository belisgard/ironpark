<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>B2P Платформа - Выбор интерфейса</title>
  <link rel="stylesheet" href="assets/css/gravity-theme.css">
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
  <div class="container" style="max-width: 980px; margin: 80px auto; text-align: center;">
    <h1 style="font-size: 32px; margin-bottom: 12px;">Выбор интерфейса</h1>
    <p id="currentUserLabel" style="color: var(--g-color-text-secondary); margin-bottom: 32px;"></p>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; margin-top: 24px;">
      <a id="b2pLink" href="partner/contracts.html" class="card" style="text-decoration: none; display: block; text-align: left;">
        <h2 style="margin-bottom: 12px;">Интерфейс B2P (B2B)</h2>
        <p style="color: var(--g-color-text-secondary); margin-bottom: 20px;">
          Работа с договорами, авто, водителями, штрафами и отчетами.
        </p>
        <span class="btn btn--primary">Открыть</span>
      </a>

      <a href="mechanic/home.html" class="card" style="text-decoration: none; display: block; text-align: left;">
        <h2 style="margin-bottom: 12px;">Интерфейс механика</h2>
        <p style="color: var(--g-color-text-secondary); margin-bottom: 20px;">
          Выдача и приёмка авто, фотофиксация и чек-листы.
        </p>
        <span class="btn btn--primary">Открыть</span>
      </a>

      <a href="car-selection/index.html" class="card" style="text-decoration: none; display: block; text-align: left;">
        <h2 style="margin-bottom: 12px;">Шаг выбора авто</h2>
        <p style="color: var(--g-color-text-secondary); margin-bottom: 20px;">
          Страница выбора транспортного средства для аренды.
        </p>
        <span class="btn btn--primary">Открыть</span>
      </a>

      <a href="car-selection/index.html?mode=change" class="card" style="text-decoration: none; display: block; text-align: left;">
        <h2 style="margin-bottom: 12px;">Смена авто</h2>
        <p style="color: var(--g-color-text-secondary); margin-bottom: 20px;">
          Переход к сценарию смены транспортного средства.
        </p>
        <span class="btn btn--primary">Открыть</span>
      </a>
    </div>

    <button id="logoutBtn" class="btn btn--normal" style="margin-top: 28px;">Выйти</button>
  </div>

  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      const emailFromQuery = params.get('email');
      const emailFromStorage = sessionStorage.getItem('managerEmail');
      const email = (emailFromQuery || emailFromStorage || '').trim();

      if (!email) {
        window.location.href = 'index.html';
        return;
      }

      sessionStorage.setItem('managerEmail', email);

      const currentUserLabel = document.getElementById('currentUserLabel');
      const b2pLink = document.getElementById('b2pLink');
      const logoutBtn = document.getElementById('logoutBtn');

      if (currentUserLabel) {
        currentUserLabel.textContent = 'Пользователь: ' + email;
      }

      if (b2pLink) {
        b2pLink.href = 'partner/contracts.html?email=' + encodeURIComponent(email);
      }

      if (logoutBtn) {
        logoutBtn.addEventListener('click', function () {
          sessionStorage.removeItem('managerEmail');
          window.location.href = 'index.html';
        });
      }
    })();
  </script>
</body>
</html>
