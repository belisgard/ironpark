<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Приёмка авто - Механик</title>
  <link rel="stylesheet" href="../assets/css/gravity-theme.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
</head>
<body>
  <div class="header">
    <div class="header__logo" onclick="window.location.href='../index.html'">B2P Платформа</div>
    <button class="btn btn--normal" onclick="window.location.href='../index.html'">Выйти</button>
  </div>

  <main class="main-content" style="max-width: 600px; margin: 0 auto; padding: 24px;">
    <div style="margin-bottom: 24px;">
      <a href="home.html" style="color: var(--g-color-text-link); text-decoration: none;">← Назад к задачам</a>
    </div>

    <h1 style="margin-bottom: 32px;">Приёмка авто</h1>

    <!-- Step 1 -->
    <div class="card" id="step1Content">
      <h3 style="margin-bottom: 16px;">Шаг 1: Авто/аренда</h3>
      <div class="form-group">
        <label class="form-label">Автомобиль</label>
        <select class="form-select" id="carSelect">
          <option value="">Выберите авто</option>
          <option value="З901ОП777">З901ОП777 - Nissan Almera</option>
        </select>
      </div>
      <button class="btn btn--action" onclick="goToStep(2)" style="width: 100%; margin-top: 16px;">Далее</button>
    </div>

    <!-- Step 2 -->
    <div class="card" id="step2Content" style="display: none;">
      <h3 style="margin-bottom: 16px;">Шаг 2: Фотофиксация возврата</h3>
      <div class="form-group">
        <label class="form-label">Загрузить фото (минимум 3)</label>
        <input type="file" class="form-input" id="photoInput" multiple accept="image/*" onchange="handlePhotoUpload(event)">
      </div>
      <div id="photoPreview" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 16px;"></div>
      <div style="display: flex; gap: 12px; margin-top: 16px;">
        <button class="btn btn--normal" onclick="goToStep(1)" style="flex: 1;">Назад</button>
        <button class="btn btn--action" onclick="goToStep(3)" id="step2Next" style="flex: 1;" disabled>Далее</button>
      </div>
    </div>

    <!-- Step 3 -->
    <div class="card" id="step3Content" style="display: none;">
      <h3 style="margin-bottom: 16px;">Шаг 3: Повреждения/комплектность</h3>
      <div class="form-group">
        <label style="display: flex; align-items: center;">
          <input type="checkbox" class="form-checkbox" id="isDamaged">
          <span style="margin-left: 8px;">Поврежден</span>
        </label>
      </div>
      <div class="form-group">
        <label style="display: flex; align-items: center;">
          <input type="checkbox" class="form-checkbox" id="isIncomplete">
          <span style="margin-left: 8px;">Некомплект</span>
        </label>
      </div>
      <div class="form-group">
        <label style="display: flex; align-items: center;">
          <input type="checkbox" class="form-checkbox" id="documentsLost">
          <span style="margin-left: 8px;">Утери документов</span>
        </label>
      </div>
      <div class="form-group">
        <label class="form-label">Комментарий</label>
        <textarea class="form-input" rows="4" placeholder="Опишите повреждения или состояние"></textarea>
      </div>
      <div style="display: flex; gap: 12px; margin-top: 16px;">
        <button class="btn btn--normal" onclick="goToStep(2)" style="flex: 1;">Назад</button>
        <button class="btn btn--action" onclick="goToStep(4)" style="flex: 1;">Далее</button>
      </div>
    </div>

    <!-- Step 4 -->
    <div class="card" id="step4Content" style="display: none;">
      <h3 style="margin-bottom: 16px;">Шаг 4: Завершение приёмки</h3>
      <p style="margin-bottom: 24px; color: var(--g-color-text-secondary);">
        Проверьте все данные перед завершением приёмки
      </p>
      <button class="btn btn--action" id="completeBtn" onclick="completeReturn()" style="width: 100%;">Завершить приёмку</button>
      <button class="btn btn--normal" onclick="goToStep(3)" style="width: 100%; margin-top: 12px;">Назад</button>
    </div>

    <!-- Success Screen -->
    <div class="card" id="successScreen" style="display: none; text-align: center;">
      <h2 style="margin-bottom: 16px; color: var(--g-color-base-success);">Приёмка завершена</h2>
      <p style="margin-bottom: 24px; color: var(--g-color-text-secondary);">
        Автомобиль успешно принят
      </p>
      <a href="inspections.html" class="btn btn--action" style="width: 100%; text-align: center; display: block;">История осмотров</a>
    </div>
  </main>

  <script>
    let currentStep = 1;
    let photos = [];

    function goToStep(step) {
      document.getElementById(`step${currentStep}Content`).style.display = 'none';
      currentStep = step;
      document.getElementById(`step${currentStep}Content`).style.display = 'block';
    }

    function handlePhotoUpload(event) {
      const files = Array.from(event.target.files);
      photos = files;
      const preview = document.getElementById('photoPreview');
      preview.innerHTML = files.map((file, index) => `
        <div style="position: relative;">
          <img src="${URL.createObjectURL(file)}" style="width: 100%; height: 100px; object-fit: cover; border-radius: var(--g-border-radius-md);">
        </div>
      `).join('');
      document.getElementById('step2Next').disabled = files.length < 3;
    }

    function completeReturn() {
      document.getElementById('step4Content').style.display = 'none';
      document.getElementById('successScreen').style.display = 'block';
    }
  </script>
</body>
</html>
